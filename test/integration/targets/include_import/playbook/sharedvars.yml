- name: verify that play can access vars after include role
  hosts: testhost
  tasks:
    - shell: echo {{testinc_defvar1|default('notdefined')}}
      register: test2
    - assert:
        that:
          - test2.stdout == 'notdefined'
    - include_role: {name: sharedvars_include_role}
      register: testa
    - shell: echo {{testinc_defvar1}}
      register: test2
    - shell: echo {{testinc_varvar1}}
      register: test3
    - assert:
        that:
          - testdep1.stdout == 'from deprole'
          - test1.stdout == 'from role'
          - test2.stdout == 'foobar'
          - test3.stdout == 'muche'

- name: verify that vars doesnt survive after play
  hosts: testhost
  tasks:
    - shell: echo {{testinc_defvar1|default('notdefined')}}
      register: test2
    - assert:
        that:
          - test2.stdout == 'notdefined'

- name: verify that we can play with default vars
  hosts: testhost
  tasks:
    - include_role: {name: sharedvars_include_role}
      vars:
        testinc_defvar1: overriden
    - shell: echo {{testinc_defvar1}}
      register: test2
    - assert:
        that:
          - test2.stdout == 'overriden'
